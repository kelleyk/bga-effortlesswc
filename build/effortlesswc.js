/*! bga-effortlesswc 2024-06-27 */
define(["require","exports","./GameBody"],function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),define(["dojo","dojo/_base/declare","ebg/core/gamegui","ebg/counter","ebg/stock","ebg/zone"],function(t,e){e("bgagame.effortlesswc",ebg.core.gamegui,new o.GameBody)})});"use strict";var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),GameBasics=function(e){function t(){var t=e.call(this)||this;return t.curstate=null,t.pendingUpdate=!1,t.currentPlayerWasActive=!1,console.log("game constructor"),t}return __extends(t,e),t.prototype.setup=function(t){console.log("(BASICS) Starting game setup",gameui),this.gamedatas=t},t.prototype.onEnteringState=function(t,e){this.curstate=t,e=e?e.args:null,this.callfn("onEnteringState_"+t,e),this.pendingUpdate&&(this.onUpdateActionButtons(t,e),this.pendingUpdate=!1)},t.prototype.onLeavingState=function(t){this.currentPlayerWasActive=!1},t.prototype.onUpdateActionButtons=function(t,e){console.log("(BASICS) onUpdateActionButtons()"),this.curstate!==t?this.pendingUpdate=!0:(this.pendingUpdate=!1,gameui.isCurrentPlayerActive()&&!1===this.currentPlayerWasActive?(console.log("onUpdateActionButtons: "+t,e,this.debugStateInfo()),this.currentPlayerWasActive=!0,this.callfn("onUpdateActionButtons_"+t,e)):this.currentPlayerWasActive=!1)},t.prototype.debugStateInfo=function(){var t=gameui.isCurrentPlayerActive(),e=!1;return"undefined"!=typeof g_replayFrom&&(e=!0),{instantaneousMode:!!gameui.instantaneousMode,isCurrentPlayerActive:t,replayMode:e}},t.prototype.ajaxcallwrapper=function(t,e,o){(e=e||{}).lock=!0,gameui.checkAction(t)&&gameui.ajaxcall("/"+gameui.game_name+"/"+gameui.game_name+"/"+t+".html",e,gameui,function(t){},o)},t.prototype.triggerUpdateActionButtons=function(){this.updatePageTitle()},t.prototype.callfn=function(t,e){if(void 0!==this[t])return console.log("Calling "+t,e),this[t](e)},t.prototype.onScriptError=function(t,e,o){if(!gameui.page_is_unloading)return console.error(t),this.inherited(arguments)},t}(GameGui=function(){}),__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();define(["require","exports"],function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.GameBody=void 0;__extends(c,o=GameBasics),c.prototype.setup=function(t){for(var e in console.log("Starting game setup",t),t.players)t.players.hasOwnProperty(e)&&(e=t.players[e],console.log(e));this.setupPlayArea(t.mutableBoardState),this.setupNotifications(),console.log("Ending game setup")},c.prototype.setupPlayArea=function(t){for(var o=this,e=0;e<6;++e)dojo.place(this.format_block("jstpl_setloc_panel",{classes:"",id:"ewc_setloc_panel_"+e}),$("ewc_setlocarea_column_"+e%2));document.querySelector("#ewc_setloc_panel_0 .ewc_setloc_location").classList.add("location_cabin"),document.querySelector("#ewc_setloc_panel_1 .ewc_setloc_location").classList.add("location_forest"),document.querySelector("#ewc_setloc_panel_2 .ewc_setloc_location").classList.add("location_garden"),document.querySelector("#ewc_setloc_panel_3 .ewc_setloc_location").classList.add("location_river"),document.querySelector("#ewc_setloc_panel_4 .ewc_setloc_location").classList.add("location_stables"),document.querySelector("#ewc_setloc_panel_5 .ewc_setloc_location").classList.add("location_city"),document.querySelector("#ewc_setloc_panel_0 .ewc_setloc_setting").classList.add("setting_battling"),document.querySelector("#ewc_setloc_panel_1 .ewc_setloc_setting").classList.add("setting_secret"),document.querySelector("#ewc_setloc_panel_2 .ewc_setloc_setting").classList.add("setting_traveling"),document.querySelector("#ewc_setloc_panel_3 .ewc_setloc_setting").classList.add("setting_active"),document.querySelector("#ewc_setloc_panel_4 .ewc_setloc_setting").classList.add("setting_eerie"),document.querySelector("#ewc_setloc_panel_5 .ewc_setloc_setting").classList.add("setting_starved"),console.log("*** qsa ***"),document.querySelectorAll(".tmp_scalable").forEach(function(t){var e=t;e.classList.contains("tmp_scaled")||(e.classList.add("tmp_scaled"),console.log("*** qsa foreach",t),o.rescaleSprite(e,.5))}),document.querySelectorAll(".tmp_scalable_cube").forEach(function(t){t.classList.contains("tmp_scaled_cube")||(t.classList.add("tmp_scale_cube"),o.rescaleSpriteCube(t,.6))}),document.querySelectorAll(".tmp_tintable").forEach(function(t){t.classList.contains("tmp_tinted")||(t.classList.add("tmp_tinted"),t.classList.contains("ewc_playercolor_teal")&&o.tintSprite(t,"#00b796"),t.classList.contains("ewc_playercolor_pink")&&o.tintSprite(t,"#ff5fa2"))})},c.prototype.onUpdateActionButtons=function(t,e){},c.prototype.resetUi=function(){},c.prototype.rescaleSprite=function(t,e){t.style.height=363.6*e+"px",t.style.width=233.4*e+"px";var o=3334.2*e+"px "+3328.2*e+"px";console.log("*** bgSize = ",o),t.style.backgroundSize=o,t.style.backgroundPosition=-700.2*e+"px "+-1090.8*e+"px"},c.prototype.rescaleSpriteCube=function(t,e){console.log("** rescaleSpriteCube()",t,e),t.style.height=30*e+"px",t.style.width=30*e+"px";var o=312*e+"px "+302.4*e+"px",o=(console.log("*** bgSize = ",o),t.style.backgroundSize=o,t.style.maskSize=o,-276*e+"px "+-121.2*e+"px");t.style.backgroundPosition=o,t.style.maskPosition=o},c.prototype.tintSprite=function(t,e){t.style.backgroundBlendMode="multiply",t.style.backgroundColor=e},c.prototype.onEnteringState=function(t,e){o.prototype.onEnteringState.call(this,t,e)},c.prototype.onLeavingState=function(t){o.prototype.onLeavingState.call(this,t)},c.prototype.setupNotifications=function(){for(var t in console.log("**setup notif**"),this)"function"==typeof this[t]&&t.startsWith("notif_")&&dojo.subscribe(t.substring(6),this,t)};var o,n=c;function c(){return console.log("effortlesswc constructor"),o.call(this)||this}e.GameBody=n});